<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årea do Aluno - Academia Fit</title>
    <link rel="stylesheet" href="../css/area-aluno.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Estilos adicionais para valida√ß√£o */
        .validation-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary);
        }
        
        .info-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 8px;
        }
        
        .info-item:last-child {
            margin-bottom: 0;
        }
        
        .info-item i {
            color: var(--primary);
            margin-top: 3px;
        }
        
        .info-item span {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .test-buttons {
            margin-top: 25px;
            text-align: center;
        }
        
        .btn-test {
            background: #6c757d;
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-test:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }
        
        .btn-test i {
            font-size: 0.8rem;
        }
        
        /* Estilos para valida√ß√£o em tempo real */
        .form-group input.error {
            border-color: #dc3545 !important;
            background-color: #fff8f8;
        }
        
        .form-group input.valid {
            border-color: #28a745 !important;
            background-color: #f8fff9;
        }
        
        .error-message {
            color: #dc3545;
            font-size: 0.85rem;
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Anima√ß√£o para o bot√£o de login */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fa-spinner {
            animation: spin 1s linear infinite;
        }
        
        /* Estilos responsivos */
        @media (max-width: 768px) {
            .test-buttons {
                margin-top: 15px;
            }
            
            .btn-test {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .info-item {
                flex-direction: column;
                gap: 5px;
            }
            
            .btn-test {
                width: 100%;
                justify-content: center;
                margin-bottom: 5px;
            }
        }
    </style>
</head>
<body class="login-page">
    <!-- BOT√ÉO PARA VOLTAR AO SITE PRINCIPAL -->
    <div class="back-to-site-container">
        <a href="../index.html" class="back-to-site-btn">
            <i class="fas fa-arrow-left"></i>
            <span>Voltar ao Site da Academia</span>
        </a>
    </div>

    <div class="login-container">
        <div class="login-header">
            <div class="logo">
                <i class="fas fa-dumbbell"></i>
                <h1>√Årea do Aluno</h1>
            </div>
            <p>Acesse sua conta para gerenciar sua jornada fitness</p>
        </div>

        <div class="login-card">
            <div class="login-illustration">
                <i class="fas fa-user-check"></i>
                <h3>Bem-vindo de volta!</h3>
                <p>Acompanhe seu progresso e gerencie sua conta</p>
            </div>

            <div class="login-form">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="cpf">
                            <i class="fas fa-id-card"></i> CPF
                        </label>
                        <input 
                            type="text" 
                            id="cpf" 
                            name="cpf" 
                            placeholder="123.456.789-09"
                            maxlength="14"
                            required
                            autocomplete="off"
                        >
                        <small class="help-text">Digite 11 n√∫meros (formato autom√°tico)</small>
                    </div>

                    <div class="form-group">
                        <label for="password">
                            <i class="fas fa-calendar-alt"></i> Data de Nascimento
                        </label>
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            placeholder="DD/MM/AAAA"
                            maxlength="10"
                            required
                            autocomplete="off"
                        >
                        <small class="help-text">Digite 8 n√∫meros (formato: DDMMAAAA)</small>
                    </div>

                    <!-- SE√á√ÉO DE INFORMA√á√ïES DE VALIDA√á√ÉO -->
                    <div class="validation-info">
                        <div class="info-item">
                            <i class="fas fa-info-circle"></i>
                            <span>CPF: Digite 11 n√∫meros (formato autom√°tico: 123.456.789-09)</span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-info-circle"></i>
                            <span>Data: Digite 8 n√∫meros (DDMMAAAA) - ser√° formatada automaticamente</span>
                        </div>
                    </div>

                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="remember">
                            <span>Lembrar meu acesso</span>
                        </label>
                        <a href="#" id="forgotPassword" class="forgot-password">Esqueceu a data?</a>
                    </div>

                    <button type="submit" class="btn-login">
                        <i class="fas fa-sign-in-alt"></i> Entrar na √Årea do Aluno
                    </button>

                    <!-- BOT√ïES DE TESTE PARA DESENVOLVIMENTO -->
                   

                   
                </form>
            </div>

            <div class="support-contact">
                <p><i class="fas fa-headset"></i> Precisa de ajuda?</p>
                <a href="https://wa.me/5511999999999" target="_blank" class="support-btn">
                    <i class="fab fa-whatsapp"></i> Falar com suporte
                </a>
            </div>
        </div>

        <div class="security-info">
            <p><i class="fas fa-shield-alt"></i> Ambiente seguro ‚Ä¢ Seus dados est√£o protegidos</p>
        </div>
    </div>

    <!-- Modal de Recupera√ß√£o -->
    <div id="recoveryModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3><i class="fas fa-key"></i> Recuperar Acesso</h3>
            <p>Entre em contato com a recep√ß√£o da academia para redefinir sua senha.</p>
            <div class="contact-options">
                <a href="tel:+5511999999999" class="contact-option">
                    <i class="fas fa-phone"></i> Ligar agora
                </a>
                <a href="https://wa.me/5511999999999" target="_blank" class="contact-option whatsapp">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </a>
                <a href="mailto:suporte@academiafit.com" class="contact-option">
                    <i class="fas fa-envelope"></i> E-mail
                </a>
            </div>
        </div>
    </div>

    <!-- Bot√£o flutuante extra para voltar ao site -->
    <div class="floating-home-btn">
        <a href="../index.html" title="Voltar ao site principal">
            <i class="fas fa-home"></i>
            <span>Site</span>
        </a>
    </div>

    <!-- SCRIPTS PRINCIPAIS -->
    <script src="../js/utils.js"></script>
    <script src="../js/alunos.js"></script>
    <script src="../js/auth.js"></script>

    <!-- SCRIPT DE INICIALIZA√á√ÉO E TESTES -->
    <script>
      
            // Feedback visual
            const btn = event.target.closest('.btn-test');
            if (btn) {
                const originalBg = btn.style.background;
                btn.style.background = 'var(--primary)';
                btn.innerHTML = `<i class="fas fa-check"></i> ${btn.textContent}`;
                
                setTimeout(() => {
                    btn.style.background = originalBg;
                    btn.innerHTML = `<i class="fas fa-user"></i> ${btn.textContent.replace('‚úì ', '')}`;
                }, 1500);
            }
            
            console.log(`‚úÖ Dados do ${aluno} preenchidos automaticamente`);
        
        
        // Inicializa√ß√£o da p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina de login inicializada');
            
            // Configurar formata√ß√£o autom√°tica do CPF
            const cpfInput = document.getElementById('cpf');
            if (cpfInput) {
                cpfInput.addEventListener('input', function() {
                    // Formata√ß√£o autom√°tica do CPF
                    let value = this.value.replace(/\D/g, '');
                    if (value.length > 11) value = value.substring(0, 11);
                    
                    if (value.length > 9) {
                        value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                    } else if (value.length > 6) {
                        value = value.replace(/(\d{3})(\d{3})(\d{1,3})/, '$1.$2.$3');
                    } else if (value.length > 3) {
                        value = value.replace(/(\d{3})(\d{1,3})/, '$1.$2');
                    }
                    
                    this.value = value;
                    
                    // Valida√ß√£o visual em tempo real
                    const cpfLimpo = value.replace(/\D/g, '');
                    if (cpfLimpo.length === 11) {
                        this.classList.remove('error');
                        this.classList.add('valid');
                    } else {
                        this.classList.remove('valid');
                        if (cpfLimpo.length > 0) {
                            this.classList.add('error');
                        }
                    }
                });
                
                // Limpar valida√ß√£o ao focar
                cpfInput.addEventListener('focus', function() {
                    this.classList.remove('error', 'valid');
                });
            }
            
            // Configurar formata√ß√£o autom√°tica da data
            const senhaInput = document.getElementById('password');
            if (senhaInput) {
                senhaInput.addEventListener('input', function(e) {
                    // Formata√ß√£o autom√°tica da data
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length > 8) value = value.substring(0, 8);
                    
                    if (value.length > 4) {
                        value = value.replace(/(\d{2})(\d{2})(\d{4})/, '$1/$2/$3');
                    } else if (value.length > 2) {
                        value = value.replace(/(\d{2})(\d{1,2})/, '$1/$2');
                    }
                    
                    e.target.value = value;
                    
                    // Valida√ß√£o visual em tempo real
                    const dataLimpa = value.replace(/\D/g, '');
                    if (dataLimpa.length === 8) {
                        e.target.classList.remove('error');
                        e.target.classList.add('valid');
                    } else {
                        e.target.classList.remove('valid');
                        if (dataLimpa.length > 0) {
                            e.target.classList.add('error');
                        }
                    }
                });
                
                // Limpar formata√ß√£o ao perder foco se incompleto
                senhaInput.addEventListener('blur', function() {
                    const value = this.value.replace(/\D/g, '');
                    if (value.length !== 8) {
                        this.value = value;
                    }
                    this.classList.remove('error', 'valid');
                });
            }
            
            // Configurar modal de recupera√ß√£o
            const forgotLink = document.getElementById('forgotPassword');
            const modal = document.getElementById('recoveryModal');
            const closeBtn = document.querySelector('.close-modal');
            
            if (forgotLink && modal) {
                forgotLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    modal.style.display = 'flex';
                });
            }
            
            if (closeBtn && modal) {
                closeBtn.addEventListener('click', function() {
                    modal.style.display = 'none';
                });
            }
            
            // Fechar modal ao clicar fora
            window.addEventListener('click', function(e) {
                if (modal && e.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Verificar se j√° est√° logado
            const savedUser = localStorage.getItem('academia_user') || sessionStorage.getItem('academia_user');
            if (savedUser) {
                try {
                    const user = JSON.parse(savedUser);
                    console.log(`üëã Bem-vindo de volta, ${user.nome}!`);
                    
                    // Mostrar mensagem de boas-vindas
                    setTimeout(() => {
                        const welcomeMsg = document.createElement('div');
                        welcomeMsg.innerHTML = `
                            <div style="
                                position: fixed;
                                top: 20px;
                                right: 20px;
                                background: var(--primary);
                                color: white;
                                padding: 10px 20px;
                                border-radius: 8px;
                                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                                z-index: 10000;
                                animation: slideIn 0.3s ease;
                            ">
                                <i class="fas fa-user-circle"></i> Ol√°, ${user.nome.split(' ')[0]}!
                            </div>
                        `;
                        document.body.appendChild(welcomeMsg);
                        
                        setTimeout(() => {
                            welcomeMsg.remove();
                        }, 3000);
                    }, 1000);
                } catch (error) {
                    console.error('Erro ao carregar usu√°rio salvo:', error);
                }
            }
        
        });
        
        // Fun√ß√£o para mostrar erros
        function mostrarErro(input, mensagem) {
            input.classList.add('error');
            
            // Remover erro anterior
            const erroAnterior = input.parentNode.querySelector('.error-message');
            if (erroAnterior) erroAnterior.remove();
            
            // Criar nova mensagem
            const erroDiv = document.createElement('div');
            erroDiv.className = 'error-message';
            erroDiv.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${mensagem}`;
            
            input.parentNode.appendChild(erroDiv);
            
            // Animar
            input.classList.add('shake');
            setTimeout(() => {
                input.classList.remove('shake');
            }, 300);
        }
        
        // Adicionar anima√ß√£o shake
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
            .shake {
                animation: shake 0.3s ease;
            }
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>